const fs = require('fs');
const path = require('path');

// –ü–∞–ø–∫–∏ –∏ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å
const –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø = {
    –ü–∞–ø–∫–∏: ['node_modules', '.git', 'Backup 1 04.01', 'userData', 'Backups'], // –î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–≥–∏–µ –ø–∞–ø–∫–∏ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    –§–∞–π–ª—ã: ['*.docx', '*.LOCK', '*.LOG'] // –î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã —Ñ–∞–π–ª–æ–≤ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
};

/**
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –∏–º—è —Ñ–∞–π–ª–∞ –æ–¥–Ω–æ–º—É –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
 * @param {string} –∏–º—è - –ò–º—è —Ñ–∞–π–ª–∞ –∏–ª–∏ –ø–∞–ø–∫–∏.
 * @param {string[]} —à–∞–±–ª–æ–Ω—ã - –ú–∞—Å—Å–∏–≤ —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.
 * @returns {boolean} - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç true, –µ—Å–ª–∏ –∏–º—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —à–∞–±–ª–æ–Ω—É –∏—Å–∫–ª—é—á–µ–Ω–∏—è.
 */
function —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç–ò—Å–∫–ª—é—á–µ–Ω–∏—é(–∏–º—è, —à–∞–±–ª–æ–Ω—ã) {
    return —à–∞–±–ª–æ–Ω—ã.some(—à–∞–±–ª–æ–Ω => {
        if (—à–∞–±–ª–æ–Ω.startsWith('*')) {
            // –ü—Ä–∏–º–µ—Ä —à–∞–±–ª–æ–Ω–∞: *.docx
            const —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ = —à–∞–±–ª–æ–Ω.slice(1);
            return –∏–º—è.endsWith(—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ);
        }
        // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        return –∏–º—è === —à–∞–±–ª–æ–Ω;
    });
}

/**
 * –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–∞.
 * @param {string} –∫–∞—Ç–∞–ª–æ–≥–ü—É—Ç—å - –ü—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–º—É –∫–∞—Ç–∞–ª–æ–≥—É.
 * @param {string} –ø—Ä–µ—Ñ–∏–∫—Å - –°—Ç—Ä–æ–∫–∞ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–µ—Ä–∞—Ä—Ö–∏–∏.
 * @param {boolean} –ø–æ—Å–ª–µ–¥–Ω–∏–π–≠–ª–µ–º–µ–Ω—Ç - –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ.
 */
function –≤—ã–≤–µ—Å—Ç–∏–°—Ç—Ä—É–∫—Ç—É—Ä—É(–∫–∞—Ç–∞–ª–æ–≥–ü—É—Ç—å, –ø—Ä–µ—Ñ–∏–∫—Å = '', –ø–æ—Å–ª–µ–¥–Ω–∏–π–≠–ª–µ–º–µ–Ω—Ç = true) {
    let —ç–ª–µ–º–µ–Ω—Ç—ã;
    try {
        —ç–ª–µ–º–µ–Ω—Ç—ã = fs.readdirSync(–∫–∞—Ç–∞–ª–æ–≥–ü—É—Ç—å, { withFileTypes: true });
    } catch (err) {
        console.error(`–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞: ${–∫–∞—Ç–∞–ª–æ–≥–ü—É—Ç—å}`);
        return;
    }

    // –§–∏–ª—å—Ç—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º
    —ç–ª–µ–º–µ–Ω—Ç—ã = —ç–ª–µ–º–µ–Ω—Ç—ã.filter(—ç–ª–µ–º–µ–Ω—Ç => {
        // –ò—Å–∫–ª—é—á–∞–µ–º –ø–∞–ø–∫–∏
        if (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç–ò—Å–∫–ª—é—á–µ–Ω–∏—é(—ç–ª–µ–º–µ–Ω—Ç.name, –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø.–ü–∞–ø–∫–∏)) {
            return false;
        }
        // –ò—Å–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª—ã
        if (—ç–ª–µ–º–µ–Ω—Ç.isFile() && —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç–ò—Å–∫–ª—é—á–µ–Ω–∏—é(—ç–ª–µ–º–µ–Ω—Ç.name, –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø.–§–∞–π–ª—ã)) {
            return false;
        }
        return true;
    });

    —ç–ª–µ–º–µ–Ω—Ç—ã.forEach((—ç–ª–µ–º–µ–Ω—Ç, –∏–Ω–¥–µ–∫—Å) => {
        const –ø–æ—Å–ª–µ–¥–Ω–∏–π = –∏–Ω–¥–µ–∫—Å === —ç–ª–µ–º–µ–Ω—Ç—ã.length - 1;
        const —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å = –ø–æ—Å–ª–µ–¥–Ω–∏–π ? '‚îî‚îÄ‚îÄ ' : '‚îú‚îÄ‚îÄ ';
        const –Ω–æ–≤—ã–π–ü—Ä–µ—Ñ–∏–∫—Å = –ø—Ä–µ—Ñ–∏–∫—Å + (–ø–æ—Å–ª–µ–¥–Ω–∏–π–≠–ª–µ–º–µ–Ω—Ç ? '    ' : '‚îÇ   ');

        if (—ç–ª–µ–º–µ–Ω—Ç.isDirectory()) {
            console.log(`${–ø—Ä–µ—Ñ–∏–∫—Å}${—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å}üìÅ ${—ç–ª–µ–º–µ–Ω—Ç.name}`);
            –≤—ã–≤–µ—Å—Ç–∏–°—Ç—Ä—É–∫—Ç—É—Ä—É(path.join(–∫–∞—Ç–∞–ª–æ–≥–ü—É—Ç—å, —ç–ª–µ–º–µ–Ω—Ç.name), –Ω–æ–≤—ã–π–ü—Ä–µ—Ñ–∏–∫—Å, –ø–æ—Å–ª–µ–¥–Ω–∏–π);
        } else {
            console.log(`${–ø—Ä–µ—Ñ–∏–∫—Å}${—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å}üìÑ ${—ç–ª–µ–º–µ–Ω—Ç.name}`);
        }
    });
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ö–æ–¥ —Å —Ç–µ–∫—É—â–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞
const —Ç–µ–∫—É—â–∏–π–ö–∞—Ç–∞–ª–æ–≥ = process.cwd();
console.log('–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–±–µ–∑ node_modules, Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π):');
–≤—ã–≤–µ—Å—Ç–∏–°—Ç—Ä—É–∫—Ç—É—Ä—É(—Ç–µ–∫—É—â–∏–π–ö–∞—Ç–∞–ª–æ–≥);
